{"ast":null,"code":"import _asyncToGenerator from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/regenerator/index.js\";import{Add}from\"@mui/icons-material\";import{Typography}from\"@mui/material\";import React from\"react\";import{makeStyles}from\"@mui/styles\";import Button from\"@mui/material/Button\";import{CardActionArea,Divider}from\"@mui/material\";import CustomDialog from\"../../../../components/dialogs/custom-dialog\";import CustomDialog2 from\"../../../../components/dialogs/custom-dialog\";import DeleteDialog from\"../../../../components/dialogs/custom-dialog\";import Card from\"@mui/material/Card\";import CardMedia from\"@mui/material/CardMedia\";import IconButton from\"@mui/material/IconButton\";import{Edit}from\"@mui/icons-material\";import{Delete}from\"@mui/icons-material\";import{Grid}from\"@mui/material\";import Box from\"@mui/system/Box\";import{onSnapshot,query,collection,db,doc,ref,deleteObject,storage,deleteDoc}from\"../../../../../data/firebase\";import{useSnackbar}from\"notistack\";import NewServiceForm from\"../../../../forms/services/new_service_form\";import CloudOffIcon from\"@mui/icons-material/CloudOff\";import{useHistory}from\"react-router-dom\";import MUIRichTextEditor from\"mui-rte\";import EditServiceForm from\"../../../../forms/services/edit_service_form\";import FeaturedServiceForm from\"../../../../forms/services/set_featured_service\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{height:320,width:\"100%\"},row:{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\"},rowHeader:{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\",padding:10},main:{display:\"flex\",flex:1,flexDirection:\"column\",margin:\"auto\",minHeight:275,minWidth:320,alignItems:\"center\"},cardMedia:{height:156,width:\"100%\"},subRow:{display:\"flex\",flexDirection:\"row\",justifyContent:\"end\",alignItems:\"center\"},lhsRow:{display:\"flex\",flexDirection:\"row\",justifyContent:\"start\",alignItems:\"center\"},avatar:{height:36,width:36},column:{display:\"flex\",flexDirection:\"column\",justifyContent:\"start\",alignItems:\"start\",padding:4}};});var ServiceItemCard=function ServiceItemCard(props){var item=props.item,type=props.type;var classes=useStyles();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),openDelete=_React$useState4[0],setOpenDelete=_React$useState4[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var history=useHistory();var deleteService=function deleteService(){setOpenDelete(false);var fileRef=ref(storage,type===\"featured\"?\"services-featured/\":\"services/\"+(item===null||item===void 0?void 0:item.id));deleteObject(fileRef).then(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return deleteDoc(doc(db,type===\"featured\"?\"services-featured\":\"services\",\"\"+(item===null||item===void 0?void 0:item.id)));case 3:enqueueSnackbar(\"Item deleted successfully\",{variant:\"success\"});_context.next=10;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.log(\"ERR: Del: \",_context.t0);enqueueSnackbar(\"Item not deleted. Try again\",{variant:\"error\"});case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}))).catch(function(err){});};var deleteBody=/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",gutterBottom:true,children:\"Are you sure you want to delete \".concat(item===null||item===void 0?void 0:item.title,\" ?\")}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:classes.subRow,children:[/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"contained\",style:{marginRight:4},onClick:function onClick(){return setOpenDelete(false);},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",variant:\"contained\",color:\"error\",onClick:deleteService,children:\"Delete\"})]})]});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CustomDialog,{open:open,title:\"Update Service\",handleClose:function handleClose(){return setOpen(false);},bodyComponent:/*#__PURE__*/_jsx(EditServiceForm,{setOpen:setOpen,img:item===null||item===void 0?void 0:item.image,title:item===null||item===void 0?void 0:item.title,id:item===null||item===void 0?void 0:item.id,body:item===null||item===void 0?void 0:item.body,summary:item===null||item===void 0?void 0:item.summary,type:type})}),/*#__PURE__*/_jsx(DeleteDialog,{open:openDelete,title:\"Delete Service\",handleClose:function handleClose(){return setOpenDelete(false);},bodyComponent:deleteBody}),/*#__PURE__*/_jsxs(Card,{elevation:3,className:classes.root,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.rowHeader,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.lhsRow,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontSize:14,children:item===null||item===void 0?void 0:item.title})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.subRow,children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"delete\",color:\"primary\",onClick:function onClick(){return setOpen(true);},children:/*#__PURE__*/_jsx(Edit,{})}),/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"delete\",color:\"error\",onClick:function onClick(){return setOpenDelete(true);},children:/*#__PURE__*/_jsx(Delete,{})})]})]}),/*#__PURE__*/_jsxs(CardActionArea// onClick={() =>\n//   history.push({\n//     pathname: \"/dashboard/service/\" + item?.id,\n//     state: {\n//       title: item?.title,\n//       image: item?.image,\n//       body: item?.body,\n//       summary: item?.summary,\n//       date: item?.createdAt,\n//       id: item?.id,\n//     },\n//   })\n// }\n,{children:[/*#__PURE__*/_jsx(CardMedia,{image:item===null||item===void 0?void 0:item.image,className:classes.cardMedia}),/*#__PURE__*/_jsx(Divider,{}),type===\"featured\"?/*#__PURE__*/_jsx(Box,{paddingX:2,children:/*#__PURE__*/_jsx(MUIRichTextEditor,{readOnly:true,inlineToolbar:false,style:{width:\"100%\",textAlign:\"center\"},defaultValue:item===null||item===void 0?void 0:item.body,toolbar:false})}):/*#__PURE__*/_jsx(Typography,{justifyContent:\"stretch\",textAlign:\"left\",gutterBottom:true,fontSize:12,color:\"black\",paddingLeft:1,paddingBottom:1,children:item===null||item===void 0?void 0:item.summary})]})]})]});};var Services=function Services(){var classes=useStyles();var history=useHistory();var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),open=_React$useState6[0],setOpen=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),open2=_React$useState8[0],setOpen2=_React$useState8[1];var _React$useState9=React.useState(null),_React$useState10=_slicedToArray(_React$useState9,2),serviceList=_React$useState10[0],setServiceList=_React$useState10[1];var _React$useState11=React.useState(null),_React$useState12=_slicedToArray(_React$useState11,2),featured=_React$useState12[0],setFeatured=_React$useState12[1];React.useEffect(function(){var q=query(collection(db,\"services\"));onSnapshot(q,function(querySnapshot){var service=[];querySnapshot.forEach(function(doc){var dat=doc.data();service===null||service===void 0?void 0:service.push(dat);});setServiceList(service);});onSnapshot(doc(db,\"featured\",\"service\"),function(doc){// console.log(\"Current data: \", doc.data());\nsetFeatured(doc.data());// dispatch(setPermSecData(doc.data()));\n});},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CustomDialog,{open:open,title:\"Add New Service\",handleClose:function handleClose(){return setOpen(false);},bodyComponent:/*#__PURE__*/_jsx(NewServiceForm,{setOpen:setOpen})}),/*#__PURE__*/_jsx(CustomDialog2,{open:open2,title:\"Set Featured Service\",handleClose:function handleClose(){return setOpen2(false);},bodyComponent:/*#__PURE__*/_jsx(FeaturedServiceForm,{setOpen:setOpen2})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.row,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.lhsRow,children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"blue\",fontSize:21,children:\"Services\"})}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:\"row\",justifyContent:\"end\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Button,{sx:{mx:2},startIcon:/*#__PURE__*/_jsx(Add,{}),color:\"primary\",variant:\"contained\",onClick:function onClick(){return setOpen2(true);},children:\"Featured Service\"}),/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(Add,{}),color:\"primary\",variant:\"contained\",onClick:function onClick(){return setOpen(true);},children:\"Add Service\"})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Featured Service\"}),/*#__PURE__*/_jsx(ServiceItemCard,{item:featured,type:\"featured\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Services\"}),serviceList&&/*#__PURE__*/_jsx(Grid,{container:true,spacing:{xs:2,md:2},columns:{xs:4,sm:8,md:12},children:serviceList===null||serviceList===void 0?void 0:serviceList.map(function(item,index){return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:6,children:/*#__PURE__*/_jsx(ServiceItemCard,{item:item,type:\"service\"})},index);})}),(serviceList===null||serviceList===void 0?void 0:serviceList.length)<1&&/*#__PURE__*/_jsx(\"div\",{className:classes.main,children:/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"auto\"},children:[/*#__PURE__*/_jsx(CloudOffIcon,{fontSize:\"large\"}),/*#__PURE__*/_jsx(Typography,{children:\"No records found\"})]})})]})]});};export default Services;","map":{"version":3,"sources":["/Users/macintosh/Developer/RSPHCMB-Admin/src/presentation/pages/dashboard/tabs/services/index.js"],"names":["Add","Typography","React","makeStyles","Button","CardActionArea","Divider","CustomDialog","CustomDialog2","DeleteDialog","Card","CardMedia","IconButton","Edit","Delete","Grid","Box","onSnapshot","query","collection","db","doc","ref","deleteObject","storage","deleteDoc","useSnackbar","NewServiceForm","CloudOffIcon","useHistory","MUIRichTextEditor","EditServiceForm","FeaturedServiceForm","useStyles","theme","root","height","width","row","display","flexDirection","justifyContent","alignItems","rowHeader","padding","main","flex","margin","minHeight","minWidth","cardMedia","subRow","lhsRow","avatar","column","ServiceItemCard","props","item","type","classes","useState","open","setOpen","openDelete","setOpenDelete","enqueueSnackbar","history","deleteService","fileRef","id","then","variant","console","log","catch","err","deleteBody","title","marginRight","image","body","summary","textAlign","Services","open2","setOpen2","serviceList","setServiceList","featured","setFeatured","useEffect","q","querySnapshot","service","forEach","dat","data","push","mx","xs","md","sm","map","index","length","marginTop"],"mappings":"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","sourcesContent":["import { Add } from \"@mui/icons-material\";\nimport { Typography } from \"@mui/material\";\nimport React from \"react\";\n\nimport { makeStyles } from \"@mui/styles\";\nimport Button from \"@mui/material/Button\";\nimport { CardActionArea, Divider } from \"@mui/material\";\nimport CustomDialog from \"../../../../components/dialogs/custom-dialog\";\nimport CustomDialog2 from \"../../../../components/dialogs/custom-dialog\";\nimport DeleteDialog from \"../../../../components/dialogs/custom-dialog\";\nimport Card from \"@mui/material/Card\";\nimport CardMedia from \"@mui/material/CardMedia\";\nimport IconButton from \"@mui/material/IconButton\";\nimport { Edit } from \"@mui/icons-material\";\nimport { Delete } from \"@mui/icons-material\";\nimport { Grid } from \"@mui/material\";\nimport Box from \"@mui/system/Box\";\nimport {\n  onSnapshot,\n  query,\n  collection,\n  db,\n  doc,\n  ref,\n  deleteObject,\n  storage,\n  deleteDoc,\n} from \"../../../../../data/firebase\";\nimport { useSnackbar } from \"notistack\";\nimport NewServiceForm from \"../../../../forms/services/new_service_form\";\nimport CloudOffIcon from \"@mui/icons-material/CloudOff\";\nimport { useHistory } from \"react-router-dom\";\nimport MUIRichTextEditor from \"mui-rte\";\nimport EditServiceForm from \"../../../../forms/services/edit_service_form\";\nimport FeaturedServiceForm from \"../../../../forms/services/set_featured_service\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    height: 320,\n    width: \"100%\",\n  },\n  row: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  rowHeader: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    padding: 10,\n  },\n  main: {\n    display: \"flex\",\n    flex: 1,\n    flexDirection: \"column\",\n    margin: \"auto\",\n    minHeight: 275,\n    minWidth: 320,\n    alignItems: \"center\",\n  },\n  cardMedia: {\n    height: 156,\n    width: \"100%\",\n  },\n  subRow: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"end\",\n    alignItems: \"center\",\n  },\n  lhsRow: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    justifyContent: \"start\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    height: 36,\n    width: 36,\n  },\n  column: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    justifyContent: \"start\",\n    alignItems: \"start\",\n    padding: 4,\n  },\n}));\n\nconst ServiceItemCard = (props) => {\n  const { item, type } = props;\n  const classes = useStyles();\n  const [open, setOpen] = React.useState(false);\n  const [openDelete, setOpenDelete] = React.useState(false);\n  const { enqueueSnackbar } = useSnackbar();\n  const history = useHistory();\n\n  const deleteService = () => {\n    setOpenDelete(false);\n    const fileRef = ref(\n      storage,\n      type === \"featured\" ? \"services-featured/\" : \"services/\" + item?.id\n    );\n\n    deleteObject(fileRef)\n      .then(async () => {\n        // Images deleted now delete from firestore,\n        try {\n          await deleteDoc(\n            doc(\n              db,\n              type === \"featured\" ? \"services-featured\" : \"services\",\n              \"\" + item?.id\n            )\n          );\n          enqueueSnackbar(`Item deleted successfully`, {\n            variant: \"success\",\n          });\n        } catch (error) {\n          console.log(\"ERR: Del: \", error);\n          enqueueSnackbar(`Item not deleted. Try again`, {\n            variant: \"error\",\n          });\n        }\n      })\n      .catch((err) => {});\n  };\n\n  const deleteBody = (\n    <div>\n      <Typography variant=\"body2\" gutterBottom>\n        {`Are you sure you want to delete ${item?.title} ?`}\n      </Typography>\n      <br />\n      <div className={classes.subRow}>\n        <Button\n          size=\"small\"\n          variant=\"contained\"\n          style={{ marginRight: 4 }}\n          onClick={() => setOpenDelete(false)}\n        >\n          Cancel\n        </Button>\n\n        <Button\n          size=\"small\"\n          variant=\"contained\"\n          color=\"error\"\n          onClick={deleteService}\n        >\n          Delete\n        </Button>\n      </div>\n    </div>\n  );\n\n  return (\n    <>\n      <CustomDialog\n        open={open}\n        title=\"Update Service\"\n        handleClose={() => setOpen(false)}\n        bodyComponent={\n          <EditServiceForm\n            setOpen={setOpen}\n            img={item?.image}\n            title={item?.title}\n            id={item?.id}\n            body={item?.body}\n            summary={item?.summary}\n            type={type}\n          />\n        }\n      />\n      <DeleteDialog\n        open={openDelete}\n        title=\"Delete Service\"\n        handleClose={() => setOpenDelete(false)}\n        bodyComponent={deleteBody}\n      />\n      <Card elevation={3} className={classes.root}>\n        <div className={classes.rowHeader}>\n          <div className={classes.lhsRow}>\n            <Typography variant=\"body2\" fontSize={14}>\n              {item?.title}\n            </Typography>\n          </div>\n          <div className={classes.subRow}>\n            <IconButton\n              aria-label=\"delete\"\n              color=\"primary\"\n              onClick={() => setOpen(true)}\n            >\n              <Edit />\n            </IconButton>\n            <IconButton\n              aria-label=\"delete\"\n              color=\"error\"\n              onClick={() => setOpenDelete(true)}\n            >\n              <Delete />\n            </IconButton>\n          </div>\n        </div>\n        <CardActionArea\n        // onClick={() =>\n        //   history.push({\n        //     pathname: \"/dashboard/service/\" + item?.id,\n        //     state: {\n        //       title: item?.title,\n        //       image: item?.image,\n        //       body: item?.body,\n        //       summary: item?.summary,\n        //       date: item?.createdAt,\n        //       id: item?.id,\n        //     },\n        //   })\n        // }\n        >\n          <CardMedia image={item?.image} className={classes.cardMedia} />\n          <Divider />\n          {/* <div className={classes.row}>\n            <Typography\n              fontSize={16}\n              color=\"black\"\n              paddingLeft={1}\n              textAlign=\"start\"\n              fontWeight=\"bold\"\n            >\n              {item?.title?.length > 75\n                ? item?.title?.substring(0, 75) + \"...\"\n                : item?.title}\n            </Typography>\n          </div> */}\n          {type === \"featured\" ? (\n            <Box paddingX={2}>\n              <MUIRichTextEditor\n                readOnly\n                inlineToolbar={false}\n                style={{ width: \"100%\", textAlign: \"center\" }}\n                defaultValue={item?.body}\n                toolbar={false}\n              />\n            </Box>\n          ) : (\n            <Typography\n              justifyContent=\"stretch\"\n              textAlign=\"left\"\n              gutterBottom\n              fontSize={12}\n              color=\"black\"\n              paddingLeft={1}\n              paddingBottom={1}\n            >\n              {item?.summary}\n            </Typography>\n          )}\n        </CardActionArea>\n      </Card>\n    </>\n  );\n};\n\nconst Services = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [open, setOpen] = React.useState(false);\n  const [open2, setOpen2] = React.useState(false);\n  const [serviceList, setServiceList] = React.useState(null);\n  const [featured, setFeatured] = React.useState(null);\n\n  React.useEffect(() => {\n    const q = query(collection(db, \"services\"));\n    onSnapshot(q, (querySnapshot) => {\n      const service = [];\n      querySnapshot.forEach((doc) => {\n        let dat = doc.data();\n        service?.push(dat);\n      });\n      setServiceList(service);\n    });\n\n    onSnapshot(doc(db, \"featured\", \"service\"), (doc) => {\n      // console.log(\"Current data: \", doc.data());\n      setFeatured(doc.data());\n      // dispatch(setPermSecData(doc.data()));\n    });\n  }, []);\n\n  return (\n    <div>\n      <CustomDialog\n        open={open}\n        title=\"Add New Service\"\n        handleClose={() => setOpen(false)}\n        bodyComponent={<NewServiceForm setOpen={setOpen} />}\n      />\n      <CustomDialog2\n        open={open2}\n        title=\"Set Featured Service\"\n        handleClose={() => setOpen2(false)}\n        bodyComponent={<FeaturedServiceForm setOpen={setOpen2} />}\n      />\n      <div className={classes.row}>\n        <div className={classes.lhsRow}>\n          <Typography variant=\"h6\" color=\"blue\" fontSize={21}>\n            Services\n          </Typography>\n        </div>\n        <Box\n          display={\"flex\"}\n          flexDirection=\"row\"\n          justifyContent=\"end\"\n          alignItems={\"center\"}\n        >\n          <Button\n            sx={{ mx: 2 }}\n            startIcon={<Add />}\n            color=\"primary\"\n            variant=\"contained\"\n            onClick={() => setOpen2(true)}\n          >\n            Featured Service\n          </Button>\n          <Button\n            startIcon={<Add />}\n            color=\"primary\"\n            variant=\"contained\"\n            onClick={() => setOpen(true)}\n          >\n            Add Service\n          </Button>\n        </Box>\n      </div>\n      <br />\n      <div>\n        <div>\n          <Typography variant=\"h6\" gutterBottom>\n            Featured Service\n          </Typography>\n          <ServiceItemCard item={featured} type={\"featured\"} />\n        </div>\n        <br />\n        <br />\n        <Typography variant=\"h6\" gutterBottom>\n          Services\n        </Typography>\n        {serviceList && (\n          <Grid\n            container\n            spacing={{ xs: 2, md: 2 }}\n            columns={{ xs: 4, sm: 8, md: 12 }}\n          >\n            {serviceList?.map((item, index) => (\n              <Grid item xs={12} sm={6} md={6} key={index}>\n                <ServiceItemCard item={item} type=\"service\" />\n              </Grid>\n            ))}\n          </Grid>\n        )}\n        {serviceList?.length < 1 && (\n          <div className={classes.main}>\n            <div style={{ marginTop: \"auto\" }}>\n              <CloudOffIcon fontSize=\"large\" />\n              <Typography>No records found</Typography>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Services;\n"]},"metadata":{},"sourceType":"module"}