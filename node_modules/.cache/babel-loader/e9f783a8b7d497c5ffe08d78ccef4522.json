{"ast":null,"code":"import _asyncToGenerator from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/regenerator/index.js\";import{Add,ArrowBackIosNew,Delete,Edit}from\"@mui/icons-material\";import{Backdrop,Button,CircularProgress,Container,Divider,IconButton,Typography}from\"@mui/material\";import{Box}from\"@mui/system\";import React from\"react\";import{useSnackbar}from\"notistack\";import{useHistory,useLocation}from\"react-router-dom\";import CustomDialog from\"../../../../../components/dialogs/custom-dialog\";import UpdateDialog from\"../../../../../components/dialogs/custom-dialog\";import DeleteDialog from\"../../../../../components/dialogs/custom-dialog\";// import AddFunctionForm from \"../../../../../forms/department/add_function\";\nimport{doc,db,deleteDoc,query,where,onSnapshot,collection}from\"../../../../../../data/firebase\";import{useSelector}from\"react-redux\";import UpdateFunctionForm from\"../../../../../forms/department/update_function\";import AddDeptFunctionForm from\"../../../../../forms/department/add_dept_function\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Item=function Item(props){var setLoading=props.setLoading,item=props.item,index=props.index;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open2=_React$useState2[0],setOpen2=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),open3=_React$useState4[0],setOpen3=_React$useState4[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var deleteFunct=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(item){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.prev=1;_context.next=4;return deleteDoc(doc(db,\"dept-functions\",\"\"+(item===null||item===void 0?void 0:item.id)));case 4:enqueueSnackbar(\"Item deleted successfully\",{variant:\"success\"});_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);console.log(\"ERR: Del: \",_context.t0);enqueueSnackbar(\"Item not deleted. Try again\",{variant:\"error\"});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return function deleteFunct(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(DeleteDialog,{open:open2,title:\"Delete Department Function\",handleClose:function handleClose(){return setOpen2(false);},bodyComponent:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{children:\"Are you sure you want to delete this function?\"}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirction:\"row\",justifyContent:\"end\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Button,{sx:{mx:1},variant:\"contained\",onClick:function onClick(){return setOpen2(false);},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",sx:{backgroundColor:\"red\"},onClick:function onClick(){return deleteFunct(item);},children:\"Delete\"})]})]})}),/*#__PURE__*/_jsx(UpdateDialog,{open:open3,title:\"Update Department Function\",handleClose:function handleClose(){return setOpen3(false);},bodyComponent:/*#__PURE__*/_jsx(UpdateFunctionForm,{func:item===null||item===void 0?void 0:item.function,id:item===null||item===void 0?void 0:item.id,setOpen:setOpen3})}),/*#__PURE__*/_jsxs(Box,{py:1,display:\"flex\",flexDirection:\"row\",justifyContent:\"start\",alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Typography,{pr:2,children:[index+1,\".\"]}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:\"row\",justifyContent:\"start\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Typography,{pl:2,flex:1,children:item===null||item===void 0?void 0:item.function}),/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return setOpen2(true);},children:/*#__PURE__*/_jsx(Delete,{})}),/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(){return setOpen3(true);},children:/*#__PURE__*/_jsx(Edit,{})})]})]}),/*#__PURE__*/_jsx(Divider,{})]});};var DepartmentInfo=function DepartmentInfo(){var _location$state2,_location$state3,_location$state4,_ref2,_location$state5;var history=useHistory();var location=useLocation();var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),open=_React$useState6[0],setOpen=_React$useState6[1];var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),functions=_React$useState8[0],setFunctions=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isLoading=_React$useState10[0],setLoading=_React$useState10[1];var _useSelector=useSelector(function(state){return state.departments;}),deptFunctions=_useSelector.deptFunctions;React.useEffect(function(){var _location$state;// const res = deptFunctions?.filter(\n//   (el) => el?.departments === location?.state?.id\n// );\n// setFunctions(res);\nvar q=query(collection(db,\"dept-functions\"),where(\"department\",\"==\",(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.id));onSnapshot(q,function(querySnapshot){var fn=[];querySnapshot.forEach(function(doc){fn.push(doc.data());});setFunctions(fn);// dispatch(setDeptFunctions(fn));\n});},[deptFunctions,functions]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Backdrop,{style:{zIndex:1200},open:isLoading,children:isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:90,thickness:3.0,style:{color:\"white\"}}):/*#__PURE__*/_jsx(\"div\",{})}),/*#__PURE__*/_jsx(CustomDialog,{open:open,title:\"Add Department Function\",handleClose:function handleClose(){return setOpen(false);},bodyComponent:/*#__PURE__*/_jsx(AddDeptFunctionForm,{deptId:location===null||location===void 0?void 0:(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.id,setOpen:setOpen})}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Box,{py:2,display:\"flex\",flexDirction:\"row\",justifyContent:\"space-between\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(ArrowBackIosNew,{}),variant:\"text\",onClick:function onClick(){return history.goBack();},children:\"Back\"})}),/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",gutterBottom:true,children:[(_location$state3=location.state)===null||_location$state3===void 0?void 0:_location$state3.title,\" \"]}),/*#__PURE__*/_jsxs(Typography,{gutterBottom:true,children:[(_location$state4=location.state)===null||_location$state4===void 0?void 0:_location$state4.description,\" \"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Functions of Department\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(Add,{}),onClick:function onClick(){return setOpen(true);},children:\"Add Function\"})]}),/*#__PURE__*/_jsx(Typography,{gutterBottom:true,hidden:((_ref2=(location===null||location===void 0?void 0:(_location$state5=location.state)===null||_location$state5===void 0?void 0:_location$state5.functions)||functions)===null||_ref2===void 0?void 0:_ref2.length)<1,children:\"Below are the roles/functions of the department\"}),/*#__PURE__*/_jsx(\"br\",{}),functions===null||functions===void 0?void 0:functions.map(function(item,index){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Item,{setLoading:setLoading,item:item,index:index})},index);}),(functions===null||functions===void 0?void 0:functions.length)<1&&/*#__PURE__*/_jsx(Box,{padding:10,display:\"flex\",flexDirection:\"row\",justifyContent:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Typography,{children:\"No records found\"})})]})]});};export default DepartmentInfo;","map":{"version":3,"sources":["/Users/macintosh/Developer/RSPHCMB-Admin/src/presentation/pages/dashboard/tabs/about/components/department_info.js"],"names":["Add","ArrowBackIosNew","Delete","Edit","Backdrop","Button","CircularProgress","Container","Divider","IconButton","Typography","Box","React","useSnackbar","useHistory","useLocation","CustomDialog","UpdateDialog","DeleteDialog","doc","db","deleteDoc","query","where","onSnapshot","collection","useSelector","UpdateFunctionForm","AddDeptFunctionForm","Item","props","setLoading","item","index","useState","open2","setOpen2","open3","setOpen3","enqueueSnackbar","deleteFunct","id","variant","console","log","mx","backgroundColor","function","DepartmentInfo","history","location","open","setOpen","functions","setFunctions","isLoading","state","departments","deptFunctions","useEffect","q","querySnapshot","fn","forEach","push","data","zIndex","color","goBack","title","description","length","map"],"mappings":"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","sourcesContent":["import { Add, ArrowBackIosNew, Delete, Edit } from \"@mui/icons-material\";\nimport {\n  Backdrop,\n  Button,\n  CircularProgress,\n  Container,\n  Divider,\n  IconButton,\n  Typography,\n} from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport React from \"react\";\nimport { useSnackbar } from \"notistack\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport CustomDialog from \"../../../../../components/dialogs/custom-dialog\";\nimport UpdateDialog from \"../../../../../components/dialogs/custom-dialog\";\nimport DeleteDialog from \"../../../../../components/dialogs/custom-dialog\";\n// import AddFunctionForm from \"../../../../../forms/department/add_function\";\nimport {\n  doc,\n  db,\n  deleteDoc,\n  query,\n  where,\n  onSnapshot,\n  collection,\n} from \"../../../../../../data/firebase\";\n\nimport { useSelector } from \"react-redux\";\nimport UpdateFunctionForm from \"../../../../../forms/department/update_function\";\nimport AddDeptFunctionForm from \"../../../../../forms/department/add_dept_function\";\n\nconst Item = (props) => {\n  let { setLoading, item, index } = props;\n\n  const [open2, setOpen2] = React.useState(false);\n  const [open3, setOpen3] = React.useState(false);\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const deleteFunct = async (item) => {\n    setLoading(true);\n    try {\n      await deleteDoc(doc(db, \"dept-functions\", \"\" + item?.id));\n      enqueueSnackbar(`Item deleted successfully`, {\n        variant: \"success\",\n      });\n    } catch (error) {\n      console.log(\"ERR: Del: \", error);\n      enqueueSnackbar(`Item not deleted. Try again`, {\n        variant: \"error\",\n      });\n    }\n  };\n\n  return (\n    <div>\n      <DeleteDialog\n        open={open2}\n        title=\"Delete Department Function\"\n        handleClose={() => setOpen2(false)}\n        bodyComponent={\n          <div>\n            <Typography>\n              Are you sure you want to delete this function?\n            </Typography>\n            <Box\n              display=\"flex\"\n              flexDirction=\"row\"\n              justifyContent={\"end\"}\n              alignItems=\"center\"\n            >\n              <Button\n                sx={{ mx: 1 }}\n                variant=\"contained\"\n                onClick={() => setOpen2(false)}\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"contained\"\n                sx={{ backgroundColor: \"red\" }}\n                onClick={() => deleteFunct(item)}\n              >\n                Delete\n              </Button>\n            </Box>\n          </div>\n        }\n      />\n      <UpdateDialog\n        open={open3}\n        title=\"Update Department Function\"\n        handleClose={() => setOpen3(false)}\n        bodyComponent={\n          <UpdateFunctionForm\n            func={item?.function}\n            id={item?.id}\n            setOpen={setOpen3}\n          />\n        }\n      />\n      <Box\n        py={1}\n        display={\"flex\"}\n        flexDirection=\"row\"\n        justifyContent={\"start\"}\n        alignItems=\"center\"\n      >\n        <Typography pr={2}>{index + 1}.</Typography>\n        <Box\n          display={\"flex\"}\n          flexDirection=\"row\"\n          justifyContent={\"start\"}\n          alignItems=\"center\"\n        >\n          <Typography pl={2} flex={1}>\n            {item?.function}\n          </Typography>\n          <IconButton onClick={() => setOpen2(true)}>\n            <Delete />\n          </IconButton>\n\n          <IconButton onClick={() => setOpen3(true)}>\n            <Edit />\n          </IconButton>\n        </Box>\n      </Box>\n      <Divider />\n    </div>\n  );\n};\n\nconst DepartmentInfo = () => {\n  const history = useHistory();\n  const location = useLocation();\n\n  const [open, setOpen] = React.useState(false);\n  const [functions, setFunctions] = React.useState();\n  const [isLoading, setLoading] = React.useState(false);\n\n  const { deptFunctions } = useSelector((state) => state.departments);\n\n  React.useEffect(() => {\n    // const res = deptFunctions?.filter(\n    //   (el) => el?.departments === location?.state?.id\n    // );\n    // setFunctions(res);\n\n    const q = query(\n      collection(db, \"dept-functions\"),\n      where(\"department\", \"==\", location.state?.id)\n    );\n    onSnapshot(q, (querySnapshot) => {\n      const fn = [];\n      querySnapshot.forEach((doc) => {\n        fn.push(doc.data());\n      });\n      setFunctions(fn);\n      // dispatch(setDeptFunctions(fn));\n    });\n  }, [deptFunctions, functions]);\n\n  return (\n    <div>\n      <Backdrop style={{ zIndex: 1200 }} open={isLoading}>\n        {isLoading ? (\n          <CircularProgress\n            size={90}\n            thickness={3.0}\n            style={{ color: \"white\" }}\n          />\n        ) : (\n          <div />\n        )}\n      </Backdrop>\n      <CustomDialog\n        open={open}\n        title=\"Add Department Function\"\n        handleClose={() => setOpen(false)}\n        bodyComponent={\n          <AddDeptFunctionForm deptId={location?.state?.id} setOpen={setOpen} />\n        }\n      />\n\n      <Container>\n        <Box\n          py={2}\n          display=\"flex\"\n          flexDirction=\"row\"\n          justifyContent={\"space-between\"}\n          alignItems=\"center\"\n        >\n          <Button\n            startIcon={<ArrowBackIosNew />}\n            variant=\"text\"\n            onClick={() => history.goBack()}\n          >\n            Back\n          </Button>\n        </Box>\n        <Typography variant=\"h5\" gutterBottom={true}>\n          {location.state?.title}{\" \"}\n        </Typography>\n        <Typography gutterBottom={true}>\n          {location.state?.description}{\" \"}\n        </Typography>\n        <br />\n        <Divider />\n        <br />\n        <Box\n          display={\"flex\"}\n          flexDirection=\"row\"\n          justifyContent={\"space-between\"}\n          alignItems=\"center\"\n        >\n          <Typography variant=\"h6\">Functions of Department</Typography>\n          <Button\n            variant=\"contained\"\n            startIcon={<Add />}\n            onClick={() => setOpen(true)}\n          >\n            Add Function\n          </Button>\n        </Box>\n        <Typography\n          gutterBottom\n          hidden={(location?.state?.functions || functions)?.length < 1}\n        >\n          Below are the roles/functions of the department\n        </Typography>\n        <br />\n        {functions?.map((item, index) => (\n          <Container key={index}>\n            <Item setLoading={setLoading} item={item} index={index} />\n          </Container>\n        ))}\n        {functions?.length < 1 && (\n          <Box\n            padding={10}\n            display=\"flex\"\n            flexDirection=\"row\"\n            justifyContent=\"center\"\n            alignItems={\"center\"}\n          >\n            <Typography>No records found</Typography>\n          </Box>\n        )}\n      </Container>\n    </div>\n  );\n};\n\nexport default DepartmentInfo;\n"]},"metadata":{},"sourceType":"module"}