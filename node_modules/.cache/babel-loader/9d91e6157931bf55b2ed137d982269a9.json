{"ast":null,"code":"import _asyncToGenerator from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/regenerator/index.js\";import{Button,LinearProgress}from\"@mui/material\";import React from\"react\";import{ValidatorForm,TextValidator}from\"react-material-ui-form-validator\";import RichText from\"../../components/misc/richtext\";import{useSnackbar}from\"notistack\";import{db,doc,updateDoc}from\"../../../data/firebase\";import{useLocation,useHistory}from\"react-router-dom\";import{ArrowBackIosNew}from\"@mui/icons-material\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UpdateWDC=function UpdateWDC(){var _location$state,_location$state2;var location=useLocation();var history=useHistory();var _React$useState=React.useState(location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.title),_React$useState2=_slicedToArray(_React$useState,2),title=_React$useState2[0],setTitle=_React$useState2[1];var _React$useState3=React.useState(location===null||location===void 0?void 0:(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.body),_React$useState4=_slicedToArray(_React$useState3,2),body=_React$useState4[0],setBody=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isError=_React$useState6[0],setIsError=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isSubmitted=_React$useState8[0],setIsSubmitted=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isSubmitting=_React$useState10[0],setIsSubmitting=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),isStartedFilling=_React$useState12[0],setIsStartedFilling=_React$useState12[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var handleChange=function handleChange(e){// setIsStartedFilling(true);\nvar value=e.target.value;setTitle(value);// setFormValues((prevData) => ({ ...prevData, [name]: value }));\n};React.useEffect(function(){if(!isSubmitted){window.addEventListener(\"beforeunload\",function(){// console.log('added');\n});}return function(){window.removeEventListener(\"beforeunload\",function(){return console.log(\"\");});};},[isStartedFilling]);var submitForm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var mRef,resp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setIsSubmitting(true);console.log(\"LO\",body);mRef=doc(db,\"contents\",\"wdc\");_context.prev=4;_context.next=7;return updateDoc(mRef,{title:title,body:body});case 7:resp=_context.sent;setIsSubmitting(false);//   console.log(\"SUCCESS MSGs\", resp);\nenqueueSnackbar(\"WDC updated successfully\",{variant:\"success\"});history.goBack();_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](4);setIsSubmitting(false);enqueueSnackbar(\"\".concat((_context.t0===null||_context.t0===void 0?void 0:_context.t0.message)||\"Error updating record\"),{variant:\"error\"});//   console.log(\"ERROR MSGs\", error);\ncase 17:case\"end\":return _context.stop();}}},_callee,null,[[4,13]]);}));return function submitForm(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(ArrowBackIosNew,{}),onClick:function onClick(){return history.goBack();},children:\"Back\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(ValidatorForm,{onSubmit:submitForm,style:{display:\"flex\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsx(TextValidator,{fullWidth:true,size:\"small\",placeholder:\"Title\",name:\"title\",required:true,label:\"Title\",value:title,onChange:handleChange,variant:\"outlined\",validators:[\"required\"],errorMessages:[\"Title is required\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(RichText,{value:body,setValue:setBody,error:isError,setError:setIsError,setIsStartedFilling:setIsStartedFilling}),isSubmitting&&/*#__PURE__*/_jsx(LinearProgress,{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{color:\"primary\",variant:\"contained\",type:\"submit\",disabled:isSubmitting,children:\"Submit\"})]})]});};export default UpdateWDC;","map":{"version":3,"sources":["/Users/macintosh/Developer/RSPHCMB-Admin/src/presentation/forms/wdc/update_wdc.js"],"names":["Button","LinearProgress","React","ValidatorForm","TextValidator","RichText","useSnackbar","db","doc","updateDoc","useLocation","useHistory","ArrowBackIosNew","UpdateWDC","location","history","useState","state","title","setTitle","body","setBody","isError","setIsError","isSubmitted","setIsSubmitted","isSubmitting","setIsSubmitting","isStartedFilling","setIsStartedFilling","enqueueSnackbar","handleChange","e","value","target","useEffect","window","addEventListener","removeEventListener","console","log","submitForm","preventDefault","mRef","resp","variant","goBack","message","display","flexDirection"],"mappings":"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","sourcesContent":["import { Button, LinearProgress } from \"@mui/material\";\nimport React from \"react\";\nimport { ValidatorForm, TextValidator } from \"react-material-ui-form-validator\";\nimport RichText from \"../../components/misc/richtext\";\nimport { useSnackbar } from \"notistack\";\nimport { db, doc, updateDoc } from \"../../../data/firebase\";\nimport { useLocation, useHistory } from \"react-router-dom\";\nimport { ArrowBackIosNew } from \"@mui/icons-material\";\n\nconst UpdateWDC = () => {\n  const location = useLocation();\n  const history = useHistory();\n\n  const [title, setTitle] = React.useState(location?.state?.title);\n  const [body, setBody] = React.useState(location?.state?.body);\n  const [isError, setIsError] = React.useState(false);\n  const [isSubmitted, setIsSubmitted] = React.useState(false);\n  const [isSubmitting, setIsSubmitting] = React.useState(false);\n  const [isStartedFilling, setIsStartedFilling] = React.useState(false);\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const handleChange = (e) => {\n    // setIsStartedFilling(true);\n    const { value } = e.target;\n    setTitle(value);\n    // setFormValues((prevData) => ({ ...prevData, [name]: value }));\n  };\n\n  React.useEffect(() => {\n    if (!isSubmitted) {\n      window.addEventListener(\"beforeunload\", () => {\n        // console.log('added');\n      });\n    }\n    return () => {\n      window.removeEventListener(\"beforeunload\", () => console.log(\"\"));\n    };\n  }, [isStartedFilling]);\n\n  const submitForm = async (e) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n\n    console.log(\"LO\", body);\n\n    const mRef = doc(db, \"contents\", \"wdc\");\n    try {\n      let resp = await updateDoc(mRef, {\n        title: title,\n        body: body,\n      });\n      setIsSubmitting(false);\n      //   console.log(\"SUCCESS MSGs\", resp);\n      enqueueSnackbar(`WDC updated successfully`, {\n        variant: \"success\",\n      });\n      history.goBack();\n    } catch (error) {\n      setIsSubmitting(false);\n      enqueueSnackbar(`${error?.message || \"Error updating record\"}`, {\n        variant: \"error\",\n      });\n      //   console.log(\"ERROR MSGs\", error);\n    }\n  };\n\n  return (\n    <div>\n      <Button startIcon={<ArrowBackIosNew />} onClick={() => history.goBack()}>\n        Back\n      </Button>\n      <br />\n      <br />\n      <ValidatorForm\n        onSubmit={submitForm}\n        style={{ display: \"flex\", flexDirection: \"column\" }}\n      >\n        <TextValidator\n          fullWidth\n          size=\"small\"\n          placeholder=\"Title\"\n          name=\"title\"\n          required\n          label=\"Title\"\n          value={title}\n          onChange={handleChange}\n          variant=\"outlined\"\n          validators={[\"required\"]}\n          errorMessages={[\"Title is required\"]}\n        />\n        <br />\n        <RichText\n          value={body}\n          setValue={setBody}\n          error={isError}\n          setError={setIsError}\n          setIsStartedFilling={setIsStartedFilling}\n        />\n        {isSubmitting && <LinearProgress />}\n        <br />\n\n        <Button\n          color=\"primary\"\n          variant=\"contained\"\n          type=\"submit\"\n          disabled={isSubmitting}\n        >\n          Submit\n        </Button>\n      </ValidatorForm>\n    </div>\n  );\n};\n\nexport default UpdateWDC;\n"]},"metadata":{},"sourceType":"module"}