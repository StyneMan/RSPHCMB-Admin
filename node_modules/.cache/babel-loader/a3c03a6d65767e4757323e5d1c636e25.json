{"ast":null,"code":"import _asyncToGenerator from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _slicedToArray from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/macintosh/Developer/RSPHCMB-Admin/node_modules/@babel/runtime/regenerator/index.js\";import React from\"react\";import{ValidatorForm,TextValidator}from\"react-material-ui-form-validator\";import Avatar from\"@mui/material/Avatar\";import{makeStyles}from\"@mui/styles\";import Button from\"@mui/material/Button\";import{db,ref,storage,doc,uploadBytesResumable,getDownloadURL,deleteObject,updateDoc}from\"../../../data/firebase\";import{useSnackbar}from\"notistack\";import Backdrop from\"@mui/material/Backdrop\";import{Box}from\"@mui/system\";import{CircularProgress}from\"@mui/material\";import{Typography}from\"@mui/material\";import{Grid}from\"@mui/material\";import{useHistory,useLocation}from\"react-router-dom\";import{ArrowBackIosNew}from\"@mui/icons-material\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{image:{margin:\"0px auto 15px auto\",width:210,height:200},mb:{marginBottom:10}};});var CircularProgressWithLabel=function CircularProgressWithLabel(props){return/*#__PURE__*/_jsxs(Box,{position:\"relative\",display:\"inline-flex\",children:[/*#__PURE__*/_jsx(CircularProgress,_objectSpread(_objectSpread({variant:\"determinate\"},props),{},{size:90,thickness:3.0,style:{color:\"green\"}})),/*#__PURE__*/_jsx(Box,{top:0,left:0,bottom:0,right:0,position:\"absolute\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",children:/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"div\",style:{color:\"white\",fontFamily:\"roboto\"},children:\"\".concat(Math.round(props.value),\"%\")})})]});};var GovernorSection=function GovernorSection(){var _location$state,_location$state4,_location$state5,_location$state6,_location$state7;var classes=useStyles();var history=useHistory();var location=useLocation();var _React$useState=React.useState({governorName:location===null||location===void 0?void 0:location.state.governorName,governorImage:\"\",deputyGovName:location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.deputyGovName,deputyGovImage:\"\"}),_React$useState2=_slicedToArray(_React$useState,2),formValues=_React$useState2[0],setFormValues=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),file=_React$useState4[0],setFile=_React$useState4[1];var _React$useState5=React.useState(null),_React$useState6=_slicedToArray(_React$useState5,2),file2=_React$useState6[0],setFile2=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isUploading=_React$useState8[0],setIsUploading=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isLoading=_React$useState10[0],setIsLoading=_React$useState10[1];var _React$useState11=React.useState(0),_React$useState12=_slicedToArray(_React$useState11,2),progress=_React$useState12[0],setProgress=_React$useState12[1];var _React$useState13=React.useState(\"\"),_React$useState14=_slicedToArray(_React$useState13,2),previewImage=_React$useState14[0],setPreviewImage=_React$useState14[1];var _React$useState15=React.useState(\"\"),_React$useState16=_slicedToArray(_React$useState15,2),previewImage2=_React$useState16[0],setPreviewImage2=_React$useState16[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var handleChange=function handleChange(e){var _e$target=e.target,id=_e$target.id,name=_e$target.name,value=_e$target.value;if(id===\"governorImage\"){setFile(e.target.files[0]);setPreviewImage(URL.createObjectURL(e.target.files[0]));setFormValues(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{governorImage:e.target.value});});}else if(id===\"deputyGovImage\"){setFile2(e.target.files[0]);setPreviewImage2(URL.createObjectURL(e.target.files[0]));setFormValues(function(prevData){return _objectSpread(_objectSpread({},prevData),{},{deputyGovImage:e.target.value});});}else{setFormValues(function(prevData){return _objectSpread(_objectSpread({},prevData),{},_defineProperty({},name,value));});}};var uploadNewImage=function uploadNewImage(){setIsUploading(true);var timeNow=new Date();//First upload image to firebase storage then save to firestore\nvar storageRef=ref(storage,\"rsphcmb-who-we-are/\"+timeNow.getTime());var uploadTask=uploadBytesResumable(storageRef,file);uploadTask.on(\"state_changed\",function(snapshot){var uprogress=snapshot.bytesTransferred/snapshot.totalBytes*100;setProgress(uprogress);},function(error){setIsUploading(false);console.log(error);enqueueSnackbar(\"\".concat(error.message),{variant:\"error\"});},function(){setIsUploading(false);setIsLoading(true);getDownloadURL(uploadTask.snapshot.ref).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(downloadURL){var mRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:mRef=doc(db,\"about\",\"rsphcmb\");_context.prev=1;_context.next=4;return updateDoc(mRef,{governorName:formValues.governorName,deputyGovName:formValues.deputyGovName,updatedAt:timeNow,governorImage:downloadURL});case 4:history.goBack();setIsLoading(false);enqueueSnackbar(\"Updated successfully\",{variant:\"success\"});_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);setIsLoading(false);enqueueSnackbar(\"\".concat((_context.t0===null||_context.t0===void 0?void 0:_context.t0.message)||\"Check your internet connection\"),{variant:\"error\"});case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function(_x){return _ref.apply(this,arguments);};}());});};var uploadNewImage2=function uploadNewImage2(){setIsUploading(true);var timeNow=new Date();//First upload image to firebase storage then save to firestore\nvar storageRef=ref(storage,\"rsphcmb-who-we-are/\"+timeNow.getTime());var uploadTask=uploadBytesResumable(storageRef,file);uploadTask.on(\"state_changed\",function(snapshot){var uprogress=snapshot.bytesTransferred/snapshot.totalBytes*100;setProgress(uprogress);},function(error){setIsUploading(false);console.log(error);enqueueSnackbar(\"\".concat(error.message),{variant:\"error\"});},function(){setIsUploading(false);setIsLoading(true);getDownloadURL(uploadTask.snapshot.ref).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(downloadURL){var mRef;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:mRef=doc(db,\"about\",\"rsphcmb\");_context2.prev=1;_context2.next=4;return updateDoc(mRef,{governorName:formValues.governorName,deputyGovName:formValues.deputyGovName,updatedAt:timeNow,deputyGovImage:downloadURL});case 4:history.goBack();setIsLoading(false);enqueueSnackbar(\"Updated successfully\",{variant:\"success\"});_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);setIsLoading(false);enqueueSnackbar(\"\".concat(_context2.t0===null||_context2.t0===void 0?void 0:_context2.t0.message),{variant:\"error\"});case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}());});};var update=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e){var _location$state2,_location$state3;var timeNow,mRef,fileRef,_fileRef,_fileRef2,fileRef2;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setIsLoading(true);setFormValues({deputyGovName:formValues.deputyGovName?formValues.deputyGovName:(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.deputyGovName,governorName:formValues.governorName?formValues.governorName:location===null||location===void 0?void 0:(_location$state3=location.state)===null||_location$state3===void 0?void 0:_location$state3.governorName});if(!(!previewImage&&!previewImage2)){_context5.next=19;break;}//No image is changed. So update all text\ntimeNow=new Date();_context5.prev=4;mRef=doc(db,\"about\",\"rsphcmb\");_context5.next=8;return updateDoc(mRef,{deputyGovName:formValues.deputyGovName,governorName:formValues.governorName,updatedAt:timeNow});case 8:history.goBack();setIsLoading(false);enqueueSnackbar(\"Updated successfully\",{variant:\"success\"});_context5.next=17;break;case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](4);setIsLoading(false);enqueueSnackbar(\"\".concat(_context5.t0===null||_context5.t0===void 0?void 0:_context5.t0.message),{variant:\"error\"});case 17:_context5.next=20;break;case 19:if(previewImage&&!previewImage2){//Change on the featured image and all texts\nfileRef=ref(storage,\"rsphcmb_who_we_are/image\");deleteObject(fileRef).then(function(){setIsLoading(false);uploadNewImage();}).catch(function(error){setIsLoading(false);console.log(\"ErR: \",error);});}else if(!previewImage&&previewImage2){//Change on the featured image and all texts\n_fileRef=ref(storage,\"rsphcmb_who_we_are/image2\");deleteObject(_fileRef).then(function(){setIsLoading(false);uploadNewImage2();}).catch(function(error){setIsLoading(false);// console.log(\"ErR: \", error);\n});}else{_fileRef2=ref(storage,\"rsphcmb_who_we_are/image\");fileRef2=ref(storage,\"rsphcmb_who_we_are/image2\");setIsLoading(true);deleteObject(_fileRef2).then(function(){//Now Delete authors photo\ndeleteObject(fileRef2).then(function(){//Both items were deleted\nvar timeNow=new Date();var storageRef=ref(storage,\"rsphcmb_who_we_are/image\");var storageRef2=ref(storage,\"rsphcmb_who_we_are/image2\");var uploadTask=uploadBytesResumable(storageRef,file);var uploadTask2=uploadBytesResumable(storageRef2,file2);setIsLoading(false);setIsUploading(true);uploadTask.on(\"state_changed\",function(snapshot){var uprogress=snapshot.bytesTransferred/snapshot.totalBytes*100;setProgress(uprogress);},function(error){setIsUploading(false);console.log(error);enqueueSnackbar(\"\".concat(error===null||error===void 0?void 0:error.message),{variant:\"error\"});},function(){var _uploadTask$snapshot;getDownloadURL(uploadTask===null||uploadTask===void 0?void 0:(_uploadTask$snapshot=uploadTask.snapshot)===null||_uploadTask$snapshot===void 0?void 0:_uploadTask$snapshot.ref).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(downloadURL){var _mRef,tmn;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_mRef=doc(db,\"about\",\"rsphcmb\");_context4.next=4;return updateDoc(_mRef,{deputyGovName:formValues.deputyGovName,governorName:formValues.governorName,updatedAt:timeNow,governorImage:downloadURL});case 4:tmn=timeNow.getTime();setIsUploading(true);setIsLoading(false);uploadTask2.on(\"state_changed\",function(snapshot2){var prog=snapshot2.bytesTransferred/snapshot2.totalBytes*100;setProgress(prog);},function(error){setIsUploading(false);console.log(error);enqueueSnackbar(\"\".concat(error===null||error===void 0?void 0:error.message),{variant:\"error\"});},function(){var _uploadTask2$snapshot;getDownloadURL(uploadTask2===null||uploadTask2===void 0?void 0:(_uploadTask2$snapshot=uploadTask2.snapshot)===null||_uploadTask2$snapshot===void 0?void 0:_uploadTask2$snapshot.ref).then(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(download){var _mRef2;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setIsUploading(false);setIsLoading(true);_context3.prev=2;_mRef2=doc(db,\"news\",\"\"+tmn);_context3.next=6;return updateDoc(_mRef2,{authorPhoto:download});case 6:history.goBack();setIsLoading(false);enqueueSnackbar(\"Updated successfully\",{variant:\"success\"});_context3.next=15;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](2);setIsLoading(false);enqueueSnackbar(\"\".concat(_context3.t0===null||_context3.t0===void 0?void 0:_context3.t0.message),{variant:\"error\"});case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[2,11]]);}));return function(_x5){return _ref5.apply(this,arguments);};}());});_context4.next=12;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](0);case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,10]]);}));return function(_x4){return _ref4.apply(this,arguments);};}());});}).catch(function(err){});// setIsLoading(false);\n// uploadNewAuthorPhoto();\n}).catch(function(error){setIsLoading(false);});}case 20:case\"end\":return _context5.stop();}}},_callee5,null,[[4,13]]);}));return function update(_x3){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Backdrop,{style:{zIndex:1200},open:isUploading||isLoading,children:[isUploading?/*#__PURE__*/_jsx(CircularProgressWithLabel,{value:progress}):/*#__PURE__*/_jsx(\"div\",{}),isLoading?/*#__PURE__*/_jsx(CircularProgress,{size:90,thickness:3.0,style:{color:\"white\"}}):/*#__PURE__*/_jsx(\"div\",{})]}),/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(ArrowBackIosNew,{}),onClick:function onClick(){return history.goBack();},children:\"Back\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(ValidatorForm,{onSubmit:update,children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,padding:1,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,md:7,children:[/*#__PURE__*/_jsx(TextValidator,{id:\"governorImage\",size:\"small\",variant:\"outlined\",value:formValues.governorImage,name:\"governorImage\",type:\"file\",fullWidth:true,disabled:isLoading,accept:\".png, .jpg, .jpeg\",onChange:handleChange,helperText:\"Governor's image is required\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(TextValidator,{className:classes.mb,label:\"Governor's Name\",multiLine:true,rows:3,size:\"small\",variant:\"outlined\",value:formValues.governorName===\" \"?location===null||location===void 0?void 0:(_location$state4=location.state)===null||_location$state4===void 0?void 0:_location$state4.governorName:!formValues.governorName?\"\":formValues.governorName,onChange:handleChange,name:\"governorName\",fullWidth:true,validators:[\"required\"],errorMessages:[\"Governor's name is required\"]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:5,children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Avatar,{variant:\"rounded\",alt:\"Passport\",src:previewImage?previewImage:location===null||location===void 0?void 0:(_location$state5=location.state)===null||_location$state5===void 0?void 0:_location$state5.governorImage,className:classes.image})})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,padding:1,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,md:7,children:[/*#__PURE__*/_jsx(TextValidator,{id:\"deputyGovImage\",size:\"small\",variant:\"outlined\",value:formValues.deputyGovImage,name:\"deputyGovImage\",type:\"file\",fullWidth:true,disabled:isLoading,accept:\".png, .jpg, .jpeg\",onChange:handleChange,helperText:\"Deputy governor's image is required\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(TextValidator,{className:classes.mb,label:\"Deputy Governor's Name\",multiLine:true,rows:3,size:\"small\",variant:\"outlined\",value:formValues.deputyGovName===\" \"?location===null||location===void 0?void 0:(_location$state6=location.state)===null||_location$state6===void 0?void 0:_location$state6.deputyGovName:!formValues.deputyGovName?\"\":formValues.deputyGovName,onChange:handleChange,name:\"deputyGovName\",fullWidth:true,validators:[\"required\"],errorMessages:[\"Deputy governor's name is required\"]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:5,children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Avatar,{variant:\"rounded\",alt:\"Passport\",src:previewImage2?previewImage2:location===null||location===void 0?void 0:(_location$state7=location.state)===null||_location$state7===void 0?void 0:_location$state7.deputyGovImage,className:classes.image})})})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",disabled:isLoading||isUploading,fullWidth:true,children:\"Update\"})]})]});};export default GovernorSection;","map":{"version":3,"sources":["/Users/macintosh/Developer/RSPHCMB-Admin/src/presentation/forms/about-rsphcmb/governor_section.js"],"names":["React","ValidatorForm","TextValidator","Avatar","makeStyles","Button","db","ref","storage","doc","uploadBytesResumable","getDownloadURL","deleteObject","updateDoc","useSnackbar","Backdrop","Box","CircularProgress","Typography","Grid","useHistory","useLocation","ArrowBackIosNew","useStyles","theme","image","margin","width","height","mb","marginBottom","CircularProgressWithLabel","props","color","fontFamily","Math","round","value","GovernorSection","classes","history","location","useState","governorName","state","governorImage","deputyGovName","deputyGovImage","formValues","setFormValues","file","setFile","file2","setFile2","isUploading","setIsUploading","isLoading","setIsLoading","progress","setProgress","previewImage","setPreviewImage","previewImage2","setPreviewImage2","enqueueSnackbar","handleChange","e","target","id","name","files","URL","createObjectURL","prevData","uploadNewImage","timeNow","Date","storageRef","getTime","uploadTask","on","snapshot","uprogress","bytesTransferred","totalBytes","error","console","log","message","variant","then","downloadURL","mRef","updatedAt","goBack","uploadNewImage2","update","fileRef","catch","fileRef2","storageRef2","uploadTask2","tmn","snapshot2","prog","download","authorPhoto","err","zIndex"],"mappings":"0nBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,aAAT,CAAwBC,aAAxB,KAA6C,kCAA7C,CACA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CACA,OAASC,UAAT,KAA2B,aAA3B,CACA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CACA,OACEC,EADF,CAEEC,GAFF,CAGEC,OAHF,CAIEC,GAJF,CAKEC,oBALF,CAMEC,cANF,CAOEC,YAPF,CAQEC,SARF,KASO,wBATP,CAUA,OAASC,WAAT,KAA4B,WAA5B,CACA,MAAOC,CAAAA,QAAP,KAAqB,wBAArB,CACA,OAASC,GAAT,KAAoB,aAApB,CACA,OAASC,gBAAT,KAAiC,eAAjC,CACA,OAASC,UAAT,KAA2B,eAA3B,CACA,OAASC,IAAT,KAAqB,eAArB,CACA,OAASC,UAAT,CAAqBC,WAArB,KAAwC,kBAAxC,CACA,OAASC,eAAT,KAAgC,qBAAhC,C,wFAEA,GAAMC,CAAAA,SAAS,CAAGnB,UAAU,CAAC,SAACoB,KAAD,QAAY,CACvCC,KAAK,CAAE,CACLC,MAAM,CAAE,oBADH,CAELC,KAAK,CAAE,GAFF,CAGLC,MAAM,CAAE,GAHH,CADgC,CAMvCC,EAAE,CAAE,CACFC,YAAY,CAAE,EADZ,CANmC,CAAZ,EAAD,CAA5B,CAWA,GAAMC,CAAAA,yBAAyB,CAAG,QAA5BA,CAAAA,yBAA4B,CAACC,KAAD,CAAW,CAC3C,mBACE,MAAC,GAAD,EAAK,QAAQ,CAAC,UAAd,CAAyB,OAAO,CAAC,aAAjC,wBACE,KAAC,gBAAD,8BACE,OAAO,CAAC,aADV,EAEMA,KAFN,MAGE,IAAI,CAAE,EAHR,CAIE,SAAS,CAAE,GAJb,CAKE,KAAK,CAAE,CAAEC,KAAK,CAAE,OAAT,CALT,GADF,cAQE,KAAC,GAAD,EACE,GAAG,CAAE,CADP,CAEE,IAAI,CAAE,CAFR,CAGE,MAAM,CAAE,CAHV,CAIE,KAAK,CAAE,CAJT,CAKE,QAAQ,CAAC,UALX,CAME,OAAO,CAAC,MANV,CAOE,UAAU,CAAC,QAPb,CAQE,cAAc,CAAC,QARjB,uBAUE,KAAC,UAAD,EACE,OAAO,CAAC,OADV,CAEE,SAAS,CAAC,KAFZ,CAGE,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAAkBC,UAAU,CAAE,QAA9B,CAHT,oBAIKC,IAAI,CAACC,KAAL,CAAWJ,KAAK,CAACK,KAAjB,CAJL,OAVF,EARF,GADF,CA2BD,CA5BD,CA8BA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,yFAC5B,GAAMC,CAAAA,OAAO,CAAGhB,SAAS,EAAzB,CACA,GAAMiB,CAAAA,OAAO,CAAGpB,UAAU,EAA1B,CACA,GAAMqB,CAAAA,QAAQ,CAAGpB,WAAW,EAA5B,CAEA,oBAAoCrB,KAAK,CAAC0C,QAAN,CAAe,CACjDC,YAAY,CAAEF,QAAF,SAAEA,QAAF,iBAAEA,QAAQ,CAAEG,KAAV,CAAgBD,YADmB,CAEjDE,aAAa,CAAE,EAFkC,CAGjDC,aAAa,CAAEL,QAAF,SAAEA,QAAF,kCAAEA,QAAQ,CAAEG,KAAZ,0CAAE,gBAAiBE,aAHiB,CAIjDC,cAAc,CAAE,EAJiC,CAAf,CAApC,oDAAOC,UAAP,qBAAmBC,aAAnB,qBAOA,qBAAwBjD,KAAK,CAAC0C,QAAN,CAAe,IAAf,CAAxB,qDAAOQ,IAAP,qBAAaC,OAAb,qBACA,qBAA0BnD,KAAK,CAAC0C,QAAN,CAAe,IAAf,CAA1B,qDAAOU,KAAP,qBAAcC,QAAd,qBACA,qBAAsCrD,KAAK,CAAC0C,QAAN,CAAe,KAAf,CAAtC,qDAAOY,WAAP,qBAAoBC,cAApB,qBACA,qBAAkCvD,KAAK,CAAC0C,QAAN,CAAe,KAAf,CAAlC,sDAAOc,SAAP,sBAAkBC,YAAlB,sBACA,sBAAgCzD,KAAK,CAAC0C,QAAN,CAAe,CAAf,CAAhC,uDAAOgB,QAAP,sBAAiBC,WAAjB,sBACA,sBAAwC3D,KAAK,CAAC0C,QAAN,CAAe,EAAf,CAAxC,uDAAOkB,YAAP,sBAAqBC,eAArB,sBACA,sBAA0C7D,KAAK,CAAC0C,QAAN,CAAe,EAAf,CAA1C,uDAAOoB,aAAP,sBAAsBC,gBAAtB,sBAEA,iBAA4BjD,WAAW,EAAvC,CAAQkD,eAAR,cAAQA,eAAR,CAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CAC1B,cAA4BA,CAAC,CAACC,MAA9B,CAAQC,EAAR,WAAQA,EAAR,CAAYC,IAAZ,WAAYA,IAAZ,CAAkBhC,KAAlB,WAAkBA,KAAlB,CAEA,GAAI+B,EAAE,GAAK,eAAX,CAA4B,CAC1BjB,OAAO,CAACe,CAAC,CAACC,MAAF,CAASG,KAAT,CAAe,CAAf,CAAD,CAAP,CACAT,eAAe,CAACU,GAAG,CAACC,eAAJ,CAAoBN,CAAC,CAACC,MAAF,CAASG,KAAT,CAAe,CAAf,CAApB,CAAD,CAAf,CACArB,aAAa,CAAC,SAACwB,QAAD,wCACTA,QADS,MAEZ5B,aAAa,CAAEqB,CAAC,CAACC,MAAF,CAAS9B,KAFZ,IAAD,CAAb,CAID,CAPD,IAOO,IAAI+B,EAAE,GAAK,gBAAX,CAA6B,CAClCf,QAAQ,CAACa,CAAC,CAACC,MAAF,CAASG,KAAT,CAAe,CAAf,CAAD,CAAR,CACAP,gBAAgB,CAACQ,GAAG,CAACC,eAAJ,CAAoBN,CAAC,CAACC,MAAF,CAASG,KAAT,CAAe,CAAf,CAApB,CAAD,CAAhB,CACArB,aAAa,CAAC,SAACwB,QAAD,wCACTA,QADS,MAEZ1B,cAAc,CAAEmB,CAAC,CAACC,MAAF,CAAS9B,KAFb,IAAD,CAAb,CAID,CAPM,IAOA,CACLY,aAAa,CAAC,SAACwB,QAAD,wCAAoBA,QAApB,wBAA+BJ,IAA/B,CAAsChC,KAAtC,IAAD,CAAb,CACD,CACF,CApBD,CAsBA,GAAMqC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3BnB,cAAc,CAAC,IAAD,CAAd,CACA,GAAMoB,CAAAA,OAAO,CAAG,GAAIC,CAAAA,IAAJ,EAAhB,CACA;AACA,GAAMC,CAAAA,UAAU,CAAGtE,GAAG,CAACC,OAAD,CAAU,sBAAwBmE,OAAO,CAACG,OAAR,EAAlC,CAAtB,CACA,GAAMC,CAAAA,UAAU,CAAGrE,oBAAoB,CAACmE,UAAD,CAAa3B,IAAb,CAAvC,CAEA6B,UAAU,CAACC,EAAX,CACE,eADF,CAEE,SAACC,QAAD,CAAc,CACZ,GAAMC,CAAAA,SAAS,CACZD,QAAQ,CAACE,gBAAT,CAA4BF,QAAQ,CAACG,UAAtC,CAAoD,GADtD,CAEAzB,WAAW,CAACuB,SAAD,CAAX,CACD,CANH,CAOE,SAACG,KAAD,CAAW,CACT9B,cAAc,CAAC,KAAD,CAAd,CACA+B,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACArB,eAAe,WAAIqB,KAAK,CAACG,OAAV,EAAqB,CAAEC,OAAO,CAAE,OAAX,CAArB,CAAf,CACD,CAXH,CAYE,UAAM,CACJlC,cAAc,CAAC,KAAD,CAAd,CACAE,YAAY,CAAC,IAAD,CAAZ,CACA9C,cAAc,CAACoE,UAAU,CAACE,QAAX,CAAoB1E,GAArB,CAAd,CAAwCmF,IAAxC,0FAA6C,iBAAOC,WAAP,2HACrCC,IADqC,CAC9BnF,GAAG,CAACH,EAAD,CAAK,OAAL,CAAc,SAAd,CAD2B,uCAGnCO,CAAAA,SAAS,CAAC+E,IAAD,CAAO,CACpBjD,YAAY,CAAEK,UAAU,CAACL,YADL,CAEpBG,aAAa,CAAEE,UAAU,CAACF,aAFN,CAGpB+C,SAAS,CAAElB,OAHS,CAIpB9B,aAAa,CAAE8C,WAJK,CAAP,CAH0B,QASzCnD,OAAO,CAACsD,MAAR,GACArC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,wBAAyB,CACtCyB,OAAO,CAAE,SAD6B,CAAzB,CAAf,CAXyC,+EAezChC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,WACV,6DAAOwB,OAAP,GAAkB,gCADR,EAEb,CACEC,OAAO,CAAE,OADX,CAFa,CAAf,CAhByC,oEAA7C,gEAwBD,CAvCH,EAyCD,CAhDD,CAkDA,GAAMM,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5BxC,cAAc,CAAC,IAAD,CAAd,CACA,GAAMoB,CAAAA,OAAO,CAAG,GAAIC,CAAAA,IAAJ,EAAhB,CACA;AACA,GAAMC,CAAAA,UAAU,CAAGtE,GAAG,CAACC,OAAD,CAAU,sBAAwBmE,OAAO,CAACG,OAAR,EAAlC,CAAtB,CACA,GAAMC,CAAAA,UAAU,CAAGrE,oBAAoB,CAACmE,UAAD,CAAa3B,IAAb,CAAvC,CAEA6B,UAAU,CAACC,EAAX,CACE,eADF,CAEE,SAACC,QAAD,CAAc,CACZ,GAAMC,CAAAA,SAAS,CACZD,QAAQ,CAACE,gBAAT,CAA4BF,QAAQ,CAACG,UAAtC,CAAoD,GADtD,CAEAzB,WAAW,CAACuB,SAAD,CAAX,CACD,CANH,CAOE,SAACG,KAAD,CAAW,CACT9B,cAAc,CAAC,KAAD,CAAd,CACA+B,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACArB,eAAe,WAAIqB,KAAK,CAACG,OAAV,EAAqB,CAAEC,OAAO,CAAE,OAAX,CAArB,CAAf,CACD,CAXH,CAYE,UAAM,CACJlC,cAAc,CAAC,KAAD,CAAd,CACAE,YAAY,CAAC,IAAD,CAAZ,CACA9C,cAAc,CAACoE,UAAU,CAACE,QAAX,CAAoB1E,GAArB,CAAd,CAAwCmF,IAAxC,2FAA6C,kBAAOC,WAAP,+HACrCC,IADqC,CAC9BnF,GAAG,CAACH,EAAD,CAAK,OAAL,CAAc,SAAd,CAD2B,yCAGnCO,CAAAA,SAAS,CAAC+E,IAAD,CAAO,CACpBjD,YAAY,CAAEK,UAAU,CAACL,YADL,CAEpBG,aAAa,CAAEE,UAAU,CAACF,aAFN,CAGpB+C,SAAS,CAAElB,OAHS,CAIpB5B,cAAc,CAAE4C,WAJI,CAAP,CAH0B,QASzCnD,OAAO,CAACsD,MAAR,GACArC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,wBAAyB,CACtCyB,OAAO,CAAE,SAD6B,CAAzB,CAAf,CAXyC,mFAezChC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,6DAAI,aAAOwB,OAAX,EAAsB,CACnCC,OAAO,CAAE,OAD0B,CAAtB,CAAf,CAhByC,sEAA7C,kEAqBD,CApCH,EAsCD,CA7CD,CA+CA,GAAMO,CAAAA,MAAM,2FAAG,kBAAO9B,CAAP,iNACbT,YAAY,CAAC,IAAD,CAAZ,CACAR,aAAa,CAAC,CACZH,aAAa,CAAEE,UAAU,CAACF,aAAX,CACXE,UAAU,CAACF,aADA,mBAEXL,QAAQ,CAACG,KAFE,2CAEX,iBAAgBE,aAHR,CAIZH,YAAY,CAAEK,UAAU,CAACL,YAAX,CACVK,UAAU,CAACL,YADD,CAEVF,QAFU,SAEVA,QAFU,mCAEVA,QAAQ,CAAEG,KAFA,2CAEV,iBAAiBD,YANT,CAAD,CAAb,CAFa,KAUT,CAACiB,YAAD,EAAiB,CAACE,aAVT,4BAWX;AACMa,OAZK,CAYK,GAAIC,CAAAA,IAAJ,EAZL,kBAcHgB,IAdG,CAcInF,GAAG,CAACH,EAAD,CAAK,OAAL,CAAc,SAAd,CAdP,wBAeHO,CAAAA,SAAS,CAAC+E,IAAD,CAAO,CACpB9C,aAAa,CAAEE,UAAU,CAACF,aADN,CAEpBH,YAAY,CAAEK,UAAU,CAACL,YAFL,CAGpBkD,SAAS,CAAElB,OAHS,CAAP,CAfN,QAoBTnC,OAAO,CAACsD,MAAR,GACArC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,wBAAyB,CACtCyB,OAAO,CAAE,SAD6B,CAAzB,CAAf,CAtBS,qFA0BThC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,6DAAI,aAAOwB,OAAX,EAAsB,CACnCC,OAAO,CAAE,OAD0B,CAAtB,CAAf,CA3BS,wCA+BN,GAAI7B,YAAY,EAAI,CAACE,aAArB,CAAoC,CACzC;AACMmC,OAFmC,CAEzB1F,GAAG,CAACC,OAAD,CAAU,0BAAV,CAFsB,CAIzCI,YAAY,CAACqF,OAAD,CAAZ,CACGP,IADH,CACQ,UAAM,CACVjC,YAAY,CAAC,KAAD,CAAZ,CACAiB,cAAc,GACf,CAJH,EAKGwB,KALH,CAKS,SAACb,KAAD,CAAW,CAChB5B,YAAY,CAAC,KAAD,CAAZ,CACA6B,OAAO,CAACC,GAAR,CAAY,OAAZ,CAAqBF,KAArB,EACD,CARH,EASD,CAbM,IAaA,IAAI,CAACzB,YAAD,EAAiBE,aAArB,CAAoC,CACzC;AACMmC,QAFmC,CAEzB1F,GAAG,CAACC,OAAD,CAAU,2BAAV,CAFsB,CAIzCI,YAAY,CAACqF,QAAD,CAAZ,CACGP,IADH,CACQ,UAAM,CACVjC,YAAY,CAAC,KAAD,CAAZ,CACAsC,eAAe,GAChB,CAJH,EAKGG,KALH,CAKS,SAACb,KAAD,CAAW,CAChB5B,YAAY,CAAC,KAAD,CAAZ,CACA;AACD,CARH,EASD,CAbM,IAaA,CACCwC,SADD,CACW1F,GAAG,CAACC,OAAD,CAAU,0BAAV,CADd,CAEC2F,QAFD,CAEY5F,GAAG,CAACC,OAAD,CAAU,2BAAV,CAFf,CAILiD,YAAY,CAAC,IAAD,CAAZ,CAEA7C,YAAY,CAACqF,SAAD,CAAZ,CACGP,IADH,CACQ,UAAM,CACV;AACA9E,YAAY,CAACuF,QAAD,CAAZ,CACGT,IADH,CACQ,UAAM,CACV;AACA,GAAMf,CAAAA,OAAO,CAAG,GAAIC,CAAAA,IAAJ,EAAhB,CACA,GAAIC,CAAAA,UAAU,CAAGtE,GAAG,CAACC,OAAD,CAAU,0BAAV,CAApB,CACA,GAAI4F,CAAAA,WAAW,CAAG7F,GAAG,CAACC,OAAD,CAAU,2BAAV,CAArB,CACA,GAAIuE,CAAAA,UAAU,CAAGrE,oBAAoB,CAACmE,UAAD,CAAa3B,IAAb,CAArC,CACA,GAAImD,CAAAA,WAAW,CAAG3F,oBAAoB,CAAC0F,WAAD,CAAchD,KAAd,CAAtC,CAEAK,YAAY,CAAC,KAAD,CAAZ,CACAF,cAAc,CAAC,IAAD,CAAd,CAEAwB,UAAU,CAACC,EAAX,CACE,eADF,CAEE,SAACC,QAAD,CAAc,CACZ,GAAMC,CAAAA,SAAS,CACZD,QAAQ,CAACE,gBAAT,CAA4BF,QAAQ,CAACG,UAAtC,CAAoD,GADtD,CAEAzB,WAAW,CAACuB,SAAD,CAAX,CACD,CANH,CAOE,SAACG,KAAD,CAAW,CACT9B,cAAc,CAAC,KAAD,CAAd,CACA+B,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACArB,eAAe,WAAIqB,KAAJ,SAAIA,KAAJ,iBAAIA,KAAK,CAAEG,OAAX,EAAsB,CAAEC,OAAO,CAAE,OAAX,CAAtB,CAAf,CACD,CAXH,CAYE,UAAM,0BACJ9E,cAAc,CAACoE,UAAD,SAACA,UAAD,uCAACA,UAAU,CAAEE,QAAb,+CAAC,qBAAsB1E,GAAvB,CAAd,CAA0CmF,IAA1C,2FACE,kBAAOC,WAAP,qJAEUC,KAFV,CAEiBnF,GAAG,CAACH,EAAD,CAAK,OAAL,CAAc,SAAd,CAFpB,wBAGUO,CAAAA,SAAS,CAAC+E,KAAD,CAAO,CACpB9C,aAAa,CAAEE,UAAU,CAACF,aADN,CAEpBH,YAAY,CAAEK,UAAU,CAACL,YAFL,CAGpBkD,SAAS,CAAElB,OAHS,CAIpB9B,aAAa,CAAE8C,WAJK,CAAP,CAHnB,QASUW,GATV,CASgB3B,OAAO,CAACG,OAAR,EAThB,CAUIvB,cAAc,CAAC,IAAD,CAAd,CACAE,YAAY,CAAC,KAAD,CAAZ,CACA4C,WAAW,CAACrB,EAAZ,CACE,eADF,CAEE,SAACuB,SAAD,CAAe,CACb,GAAMC,CAAAA,IAAI,CACPD,SAAS,CAACpB,gBAAV,CACCoB,SAAS,CAACnB,UADZ,CAEA,GAHF,CAIAzB,WAAW,CAAC6C,IAAD,CAAX,CACD,CARH,CASE,SAACnB,KAAD,CAAW,CACT9B,cAAc,CAAC,KAAD,CAAd,CACA+B,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACArB,eAAe,WAAIqB,KAAJ,SAAIA,KAAJ,iBAAIA,KAAK,CAAEG,OAAX,EAAsB,CACnCC,OAAO,CAAE,OAD0B,CAAtB,CAAf,CAGD,CAfH,CAgBE,UAAM,2BACJ9E,cAAc,CAAC0F,WAAD,SAACA,WAAD,wCAACA,WAAW,CAAEpB,QAAd,gDAAC,sBAAuB1E,GAAxB,CAAd,CAA2CmF,IAA3C,2FACE,kBAAOe,QAAP,iIACElD,cAAc,CAAC,KAAD,CAAd,CACAE,YAAY,CAAC,IAAD,CAAZ,CAFF,iBAIUmC,MAJV,CAIiBnF,GAAG,CAACH,EAAD,CAAK,MAAL,CAAa,GAAKgG,GAAlB,CAJpB,wBAKUzF,CAAAA,SAAS,CAAC+E,MAAD,CAAO,CACpBc,WAAW,CAAED,QADO,CAAP,CALnB,QAQIjE,OAAO,CAACsD,MAAR,GACArC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,wBAAyB,CACtCyB,OAAO,CAAE,SAD6B,CAAzB,CAAf,CAVJ,qFAcIhC,YAAY,CAAC,KAAD,CAAZ,CACAO,eAAe,6DAAI,aAAOwB,OAAX,EAAsB,CACnCC,OAAO,CAAE,OAD0B,CAAtB,CAAf,CAfJ,uEADF,kEAsBD,CAvCH,EAZJ,4JADF,kEAyDD,CAtEH,EAwED,CApFH,EAqFGS,KArFH,CAqFS,SAACS,GAAD,CAAS,CAAE,CArFpB,EAsFA;AACA;AACD,CA3FH,EA4FGT,KA5FH,CA4FS,SAACb,KAAD,CAAW,CAChB5B,YAAY,CAAC,KAAD,CAAZ,CACD,CA9FH,EA+FD,CA9JY,uEAAH,kBAANuC,CAAAA,MAAM,8CAAZ,CAiKA,mBACE,oCACE,MAAC,QAAD,EAAU,KAAK,CAAE,CAAEY,MAAM,CAAE,IAAV,CAAjB,CAAmC,IAAI,CAAEtD,WAAW,EAAIE,SAAxD,WACGF,WAAW,cAAG,KAAC,yBAAD,EAA2B,KAAK,CAAEI,QAAlC,EAAH,cAAoD,cADlE,CAEGF,SAAS,cACR,KAAC,gBAAD,EACE,IAAI,CAAE,EADR,CAEE,SAAS,CAAE,GAFb,CAGE,KAAK,CAAE,CAAEvB,KAAK,CAAE,OAAT,CAHT,EADQ,cAOR,cATJ,GADF,cAaE,KAAC,MAAD,EAAQ,SAAS,cAAE,KAAC,eAAD,IAAnB,CAAwC,OAAO,CAAE,yBAAMO,CAAAA,OAAO,CAACsD,MAAR,EAAN,EAAjD,kBAbF,cAgBE,aAhBF,cAiBE,MAAC,aAAD,EAAe,QAAQ,CAAEE,MAAzB,wBACE,MAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAE,CAAzB,CAA4B,OAAO,CAAE,CAArC,wBACE,MAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,CAAmB,EAAE,CAAE,CAAvB,CAA0B,EAAE,CAAE,CAA9B,wBACE,KAAC,aAAD,EACE,EAAE,CAAC,eADL,CAEE,IAAI,CAAC,OAFP,CAGE,OAAO,CAAC,UAHV,CAIE,KAAK,CAAEhD,UAAU,CAACH,aAJpB,CAKE,IAAI,CAAC,eALP,CAME,IAAI,CAAC,MANP,CAOE,SAAS,KAPX,CAQE,QAAQ,CAAEW,SARZ,CASE,MAAM,CAAC,mBATT,CAUE,QAAQ,CAAES,YAVZ,CAWE,UAAU,CAAC,8BAXb,EADF,cAcE,aAdF,cAeE,KAAC,aAAD,EACE,SAAS,CAAE1B,OAAO,CAACV,EADrB,CAEE,KAAK,CAAC,iBAFR,CAGE,SAAS,CAAE,IAHb,CAIE,IAAI,CAAE,CAJR,CAKE,IAAI,CAAC,OALP,CAME,OAAO,CAAC,UANV,CAOE,KAAK,CACHmB,UAAU,CAACL,YAAX,GAA4B,GAA5B,CACIF,QADJ,SACIA,QADJ,mCACIA,QAAQ,CAAEG,KADd,2CACI,iBAAiBD,YADrB,CAEI,CAACK,UAAU,CAACL,YAAZ,CACA,EADA,CAEAK,UAAU,CAACL,YAZnB,CAcE,QAAQ,CAAEsB,YAdZ,CAeE,IAAI,CAAC,cAfP,CAgBE,SAAS,KAhBX,CAiBE,UAAU,CAAE,CAAC,UAAD,CAjBd,CAkBE,aAAa,CAAE,CAAC,6BAAD,CAlBjB,EAfF,GADF,cAsCE,KAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,CAAmB,EAAE,CAAE,CAAvB,CAA0B,EAAE,CAAE,CAA9B,uBACE,kCACE,KAAC,MAAD,EACE,OAAO,CAAC,SADV,CAEE,GAAG,CAAC,UAFN,CAGE,GAAG,CACDL,YAAY,CAAGA,YAAH,CAAkBnB,QAAlB,SAAkBA,QAAlB,mCAAkBA,QAAQ,CAAEG,KAA5B,2CAAkB,iBAAiBC,aAJnD,CAME,SAAS,CAAEN,OAAO,CAACd,KANrB,EADF,EADF,EAtCF,GADF,cAoDE,aApDF,cAsDE,MAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAE,CAAzB,CAA4B,OAAO,CAAE,CAArC,wBACE,MAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,CAAmB,EAAE,CAAE,CAAvB,CAA0B,EAAE,CAAE,CAA9B,wBACE,KAAC,aAAD,EACE,EAAE,CAAC,gBADL,CAEE,IAAI,CAAC,OAFP,CAGE,OAAO,CAAC,UAHV,CAIE,KAAK,CAAEuB,UAAU,CAACD,cAJpB,CAKE,IAAI,CAAC,gBALP,CAME,IAAI,CAAC,MANP,CAOE,SAAS,KAPX,CAQE,QAAQ,CAAES,SARZ,CASE,MAAM,CAAC,mBATT,CAUE,QAAQ,CAAES,YAVZ,CAWE,UAAU,CAAC,qCAXb,EADF,cAcE,aAdF,cAeE,KAAC,aAAD,EACE,SAAS,CAAE1B,OAAO,CAACV,EADrB,CAEE,KAAK,CAAC,wBAFR,CAGE,SAAS,CAAE,IAHb,CAIE,IAAI,CAAE,CAJR,CAKE,IAAI,CAAC,OALP,CAME,OAAO,CAAC,UANV,CAOE,KAAK,CACHmB,UAAU,CAACF,aAAX,GAA6B,GAA7B,CACIL,QADJ,SACIA,QADJ,mCACIA,QAAQ,CAAEG,KADd,2CACI,iBAAiBE,aADrB,CAEI,CAACE,UAAU,CAACF,aAAZ,CACA,EADA,CAEAE,UAAU,CAACF,aAZnB,CAcE,QAAQ,CAAEmB,YAdZ,CAeE,IAAI,CAAC,eAfP,CAgBE,SAAS,KAhBX,CAiBE,UAAU,CAAE,CAAC,UAAD,CAjBd,CAkBE,aAAa,CAAE,CAAC,oCAAD,CAlBjB,EAfF,GADF,cAsCE,KAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,CAAmB,EAAE,CAAE,CAAvB,CAA0B,EAAE,CAAE,CAA9B,uBACE,kCACE,KAAC,MAAD,EACE,OAAO,CAAC,SADV,CAEE,GAAG,CAAC,UAFN,CAGE,GAAG,CACDH,aAAa,CACTA,aADS,CAETrB,QAFS,SAETA,QAFS,mCAETA,QAAQ,CAAEG,KAFD,2CAET,iBAAiBG,cANzB,CAQE,SAAS,CAAER,OAAO,CAACd,KARrB,EADF,EADF,EAtCF,GAtDF,cA4GE,KAAC,MAAD,EACE,IAAI,CAAC,QADP,CAEE,OAAO,CAAC,WAFV,CAGE,QAAQ,CAAE+B,SAAS,EAAIF,WAHzB,CAIE,SAAS,KAJX,oBA5GF,GAjBF,GADF,CAyID,CAvbD,CAybA,cAAehB,CAAAA,eAAf","sourcesContent":["import React from \"react\";\nimport { ValidatorForm, TextValidator } from \"react-material-ui-form-validator\";\nimport Avatar from \"@mui/material/Avatar\";\nimport { makeStyles } from \"@mui/styles\";\nimport Button from \"@mui/material/Button\";\nimport {\n  db,\n  ref,\n  storage,\n  doc,\n  uploadBytesResumable,\n  getDownloadURL,\n  deleteObject,\n  updateDoc,\n} from \"../../../data/firebase\";\nimport { useSnackbar } from \"notistack\";\nimport Backdrop from \"@mui/material/Backdrop\";\nimport { Box } from \"@mui/system\";\nimport { CircularProgress } from \"@mui/material\";\nimport { Typography } from \"@mui/material\";\nimport { Grid } from \"@mui/material\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport { ArrowBackIosNew } from \"@mui/icons-material\";\n\nconst useStyles = makeStyles((theme) => ({\n  image: {\n    margin: \"0px auto 15px auto\",\n    width: 210,\n    height: 200,\n  },\n  mb: {\n    marginBottom: 10,\n  },\n}));\n\nconst CircularProgressWithLabel = (props) => {\n  return (\n    <Box position=\"relative\" display=\"inline-flex\">\n      <CircularProgress\n        variant=\"determinate\"\n        {...props}\n        size={90}\n        thickness={3.0}\n        style={{ color: \"green\" }}\n      />\n      <Box\n        top={0}\n        left={0}\n        bottom={0}\n        right={0}\n        position=\"absolute\"\n        display=\"flex\"\n        alignItems=\"center\"\n        justifyContent=\"center\"\n      >\n        <Typography\n          variant=\"body1\"\n          component=\"div\"\n          style={{ color: \"white\", fontFamily: \"roboto\" }}\n        >{`${Math.round(props.value)}%`}</Typography>\n      </Box>\n    </Box>\n  );\n};\n\nconst GovernorSection = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const location = useLocation();\n\n  const [formValues, setFormValues] = React.useState({\n    governorName: location?.state.governorName,\n    governorImage: \"\",\n    deputyGovName: location?.state?.deputyGovName,\n    deputyGovImage: \"\",\n  });\n\n  const [file, setFile] = React.useState(null);\n  const [file2, setFile2] = React.useState(null);\n  const [isUploading, setIsUploading] = React.useState(false);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [progress, setProgress] = React.useState(0);\n  const [previewImage, setPreviewImage] = React.useState(\"\");\n  const [previewImage2, setPreviewImage2] = React.useState(\"\");\n\n  const { enqueueSnackbar } = useSnackbar();\n\n  const handleChange = (e) => {\n    const { id, name, value } = e.target;\n\n    if (id === \"governorImage\") {\n      setFile(e.target.files[0]);\n      setPreviewImage(URL.createObjectURL(e.target.files[0]));\n      setFormValues((prevData) => ({\n        ...prevData,\n        governorImage: e.target.value,\n      }));\n    } else if (id === \"deputyGovImage\") {\n      setFile2(e.target.files[0]);\n      setPreviewImage2(URL.createObjectURL(e.target.files[0]));\n      setFormValues((prevData) => ({\n        ...prevData,\n        deputyGovImage: e.target.value,\n      }));\n    } else {\n      setFormValues((prevData) => ({ ...prevData, [name]: value }));\n    }\n  };\n\n  const uploadNewImage = () => {\n    setIsUploading(true);\n    const timeNow = new Date();\n    //First upload image to firebase storage then save to firestore\n    const storageRef = ref(storage, \"rsphcmb-who-we-are/\" + timeNow.getTime());\n    const uploadTask = uploadBytesResumable(storageRef, file);\n\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        const uprogress =\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n        setProgress(uprogress);\n      },\n      (error) => {\n        setIsUploading(false);\n        console.log(error);\n        enqueueSnackbar(`${error.message}`, { variant: \"error\" });\n      },\n      () => {\n        setIsUploading(false);\n        setIsLoading(true);\n        getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\n          const mRef = doc(db, \"about\", \"rsphcmb\");\n          try {\n            await updateDoc(mRef, {\n              governorName: formValues.governorName,\n              deputyGovName: formValues.deputyGovName,\n              updatedAt: timeNow,\n              governorImage: downloadURL,\n            });\n            history.goBack();\n            setIsLoading(false);\n            enqueueSnackbar(`Updated successfully`, {\n              variant: \"success\",\n            });\n          } catch (error) {\n            setIsLoading(false);\n            enqueueSnackbar(\n              `${error?.message || \"Check your internet connection\"}`,\n              {\n                variant: \"error\",\n              }\n            );\n          }\n        });\n      }\n    );\n  };\n\n  const uploadNewImage2 = () => {\n    setIsUploading(true);\n    const timeNow = new Date();\n    //First upload image to firebase storage then save to firestore\n    const storageRef = ref(storage, \"rsphcmb-who-we-are/\" + timeNow.getTime());\n    const uploadTask = uploadBytesResumable(storageRef, file);\n\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        const uprogress =\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n        setProgress(uprogress);\n      },\n      (error) => {\n        setIsUploading(false);\n        console.log(error);\n        enqueueSnackbar(`${error.message}`, { variant: \"error\" });\n      },\n      () => {\n        setIsUploading(false);\n        setIsLoading(true);\n        getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\n          const mRef = doc(db, \"about\", \"rsphcmb\");\n          try {\n            await updateDoc(mRef, {\n              governorName: formValues.governorName,\n              deputyGovName: formValues.deputyGovName,\n              updatedAt: timeNow,\n              deputyGovImage: downloadURL,\n            });\n            history.goBack();\n            setIsLoading(false);\n            enqueueSnackbar(`Updated successfully`, {\n              variant: \"success\",\n            });\n          } catch (error) {\n            setIsLoading(false);\n            enqueueSnackbar(`${error?.message}`, {\n              variant: \"error\",\n            });\n          }\n        });\n      }\n    );\n  };\n\n  const update = async (e) => {\n    setIsLoading(true);\n    setFormValues({\n      deputyGovName: formValues.deputyGovName\n        ? formValues.deputyGovName\n        : location.state?.deputyGovName,\n      governorName: formValues.governorName\n        ? formValues.governorName\n        : location?.state?.governorName,\n    });\n    if (!previewImage && !previewImage2) {\n      //No image is changed. So update all text\n      const timeNow = new Date();\n      try {\n        const mRef = doc(db, \"about\", \"rsphcmb\");\n        await updateDoc(mRef, {\n          deputyGovName: formValues.deputyGovName,\n          governorName: formValues.governorName,\n          updatedAt: timeNow,\n        });\n        history.goBack();\n        setIsLoading(false);\n        enqueueSnackbar(`Updated successfully`, {\n          variant: \"success\",\n        });\n      } catch (error) {\n        setIsLoading(false);\n        enqueueSnackbar(`${error?.message}`, {\n          variant: \"error\",\n        });\n      }\n    } else if (previewImage && !previewImage2) {\n      //Change on the featured image and all texts\n      const fileRef = ref(storage, \"rsphcmb_who_we_are/image\");\n\n      deleteObject(fileRef)\n        .then(() => {\n          setIsLoading(false);\n          uploadNewImage();\n        })\n        .catch((error) => {\n          setIsLoading(false);\n          console.log(\"ErR: \", error);\n        });\n    } else if (!previewImage && previewImage2) {\n      //Change on the featured image and all texts\n      const fileRef = ref(storage, \"rsphcmb_who_we_are/image2\");\n\n      deleteObject(fileRef)\n        .then(() => {\n          setIsLoading(false);\n          uploadNewImage2();\n        })\n        .catch((error) => {\n          setIsLoading(false);\n          // console.log(\"ErR: \", error);\n        });\n    } else {\n      const fileRef = ref(storage, \"rsphcmb_who_we_are/image\");\n      const fileRef2 = ref(storage, \"rsphcmb_who_we_are/image2\");\n\n      setIsLoading(true);\n\n      deleteObject(fileRef)\n        .then(() => {\n          //Now Delete authors photo\n          deleteObject(fileRef2)\n            .then(() => {\n              //Both items were deleted\n              const timeNow = new Date();\n              let storageRef = ref(storage, \"rsphcmb_who_we_are/image\");\n              let storageRef2 = ref(storage, \"rsphcmb_who_we_are/image2\");\n              let uploadTask = uploadBytesResumable(storageRef, file);\n              let uploadTask2 = uploadBytesResumable(storageRef2, file2);\n\n              setIsLoading(false);\n              setIsUploading(true);\n\n              uploadTask.on(\n                \"state_changed\",\n                (snapshot) => {\n                  const uprogress =\n                    (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n                  setProgress(uprogress);\n                },\n                (error) => {\n                  setIsUploading(false);\n                  console.log(error);\n                  enqueueSnackbar(`${error?.message}`, { variant: \"error\" });\n                },\n                () => {\n                  getDownloadURL(uploadTask?.snapshot?.ref).then(\n                    async (downloadURL) => {\n                      try {\n                        const mRef = doc(db, \"about\", \"rsphcmb\");\n                        await updateDoc(mRef, {\n                          deputyGovName: formValues.deputyGovName,\n                          governorName: formValues.governorName,\n                          updatedAt: timeNow,\n                          governorImage: downloadURL,\n                        });\n                        const tmn = timeNow.getTime();\n                        setIsUploading(true);\n                        setIsLoading(false);\n                        uploadTask2.on(\n                          \"state_changed\",\n                          (snapshot2) => {\n                            const prog =\n                              (snapshot2.bytesTransferred /\n                                snapshot2.totalBytes) *\n                              100;\n                            setProgress(prog);\n                          },\n                          (error) => {\n                            setIsUploading(false);\n                            console.log(error);\n                            enqueueSnackbar(`${error?.message}`, {\n                              variant: \"error\",\n                            });\n                          },\n                          () => {\n                            getDownloadURL(uploadTask2?.snapshot?.ref).then(\n                              async (download) => {\n                                setIsUploading(false);\n                                setIsLoading(true);\n                                try {\n                                  const mRef = doc(db, \"news\", \"\" + tmn);\n                                  await updateDoc(mRef, {\n                                    authorPhoto: download,\n                                  });\n                                  history.goBack();\n                                  setIsLoading(false);\n                                  enqueueSnackbar(`Updated successfully`, {\n                                    variant: \"success\",\n                                  });\n                                } catch (error) {\n                                  setIsLoading(false);\n                                  enqueueSnackbar(`${error?.message}`, {\n                                    variant: \"error\",\n                                  });\n                                }\n                              }\n                            );\n                          }\n                        );\n                      } catch (error) {}\n                    }\n                  );\n                }\n              );\n            })\n            .catch((err) => {});\n          // setIsLoading(false);\n          // uploadNewAuthorPhoto();\n        })\n        .catch((error) => {\n          setIsLoading(false);\n        });\n    }\n  };\n\n  return (\n    <div>\n      <Backdrop style={{ zIndex: 1200 }} open={isUploading || isLoading}>\n        {isUploading ? <CircularProgressWithLabel value={progress} /> : <div />}\n        {isLoading ? (\n          <CircularProgress\n            size={90}\n            thickness={3.0}\n            style={{ color: \"white\" }}\n          />\n        ) : (\n          <div />\n        )}\n      </Backdrop>\n      <Button startIcon={<ArrowBackIosNew />} onClick={() => history.goBack()}>\n        Back\n      </Button>\n      <br />\n      <ValidatorForm onSubmit={update}>\n        <Grid container spacing={1} padding={1}>\n          <Grid item xs={12} sm={6} md={7}>\n            <TextValidator\n              id=\"governorImage\"\n              size=\"small\"\n              variant=\"outlined\"\n              value={formValues.governorImage}\n              name=\"governorImage\"\n              type=\"file\"\n              fullWidth\n              disabled={isLoading}\n              accept=\".png, .jpg, .jpeg\"\n              onChange={handleChange}\n              helperText=\"Governor's image is required\"\n            />\n            <br />\n            <TextValidator\n              className={classes.mb}\n              label=\"Governor's Name\"\n              multiLine={true}\n              rows={3}\n              size=\"small\"\n              variant=\"outlined\"\n              value={\n                formValues.governorName === \" \"\n                  ? location?.state?.governorName\n                  : !formValues.governorName\n                  ? \"\"\n                  : formValues.governorName\n              }\n              onChange={handleChange}\n              name=\"governorName\"\n              fullWidth\n              validators={[\"required\"]}\n              errorMessages={[\"Governor's name is required\"]}\n            />\n          </Grid>\n\n          <Grid item xs={12} sm={6} md={5}>\n            <div>\n              <Avatar\n                variant=\"rounded\"\n                alt=\"Passport\"\n                src={\n                  previewImage ? previewImage : location?.state?.governorImage\n                }\n                className={classes.image}\n              />\n            </div>\n          </Grid>\n        </Grid>\n        <br />\n\n        <Grid container spacing={1} padding={1}>\n          <Grid item xs={12} sm={6} md={7}>\n            <TextValidator\n              id=\"deputyGovImage\"\n              size=\"small\"\n              variant=\"outlined\"\n              value={formValues.deputyGovImage}\n              name=\"deputyGovImage\"\n              type=\"file\"\n              fullWidth\n              disabled={isLoading}\n              accept=\".png, .jpg, .jpeg\"\n              onChange={handleChange}\n              helperText=\"Deputy governor's image is required\"\n            />\n            <br />\n            <TextValidator\n              className={classes.mb}\n              label=\"Deputy Governor's Name\"\n              multiLine={true}\n              rows={3}\n              size=\"small\"\n              variant=\"outlined\"\n              value={\n                formValues.deputyGovName === \" \"\n                  ? location?.state?.deputyGovName\n                  : !formValues.deputyGovName\n                  ? \"\"\n                  : formValues.deputyGovName\n              }\n              onChange={handleChange}\n              name=\"deputyGovName\"\n              fullWidth\n              validators={[\"required\"]}\n              errorMessages={[\"Deputy governor's name is required\"]}\n            />\n          </Grid>\n\n          <Grid item xs={12} sm={6} md={5}>\n            <div>\n              <Avatar\n                variant=\"rounded\"\n                alt=\"Passport\"\n                src={\n                  previewImage2\n                    ? previewImage2\n                    : location?.state?.deputyGovImage\n                }\n                className={classes.image}\n              />\n            </div>\n          </Grid>\n        </Grid>\n\n        <Button\n          type=\"submit\"\n          variant=\"contained\"\n          disabled={isLoading || isUploading}\n          fullWidth\n        >\n          Update\n        </Button>\n      </ValidatorForm>\n    </div>\n  );\n};\n\nexport default GovernorSection;\n"]},"metadata":{},"sourceType":"module"}